<%- include('header') -%>

<!--start main wrapper-->
<main class="main-wrapper">
    <div class="main-content">
        <!--breadcrumb-->
        <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
            <div class="ps-3">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0 p-0">
                        <li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt"></i></a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">Products</li>
                    </ol>
                </nav>
            </div>
            <div class="ms-auto">
                <div class="btn-group">
                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-end"> <a class="dropdown-item"
                            href="javascript:;">Action</a>
                        <a class="dropdown-item" href="javascript:;">Another action</a>
                        <a class="dropdown-item" href="javascript:;">Something else here</a>
                        <div class="dropdown-divider"></div> <a class="dropdown-item" href="javascript:;">Separated
                            link</a>
                    </div>
                </div>
            </div>
        </div>
        <% all=0 %>
        <% Countcategories.forEach(function(items) { 
            all += items.Category_Count
            %>
        <% }); %>

        <div class="product-count d-flex align-items-center gap-3 gap-lg-4 mb-4 fw-medium flex-wrap font-text1">
            <a href="/admin/list-product/all-product"><span class="me-1">All</span><span
                    class="text-secondary">(<%= all %>)</span></a>
            <% Countcategories.forEach(function(items) { 
                all += items.Category_Count
                %>
            <a href="/admin/list-product/<%=items.name_category%>"><span
                    class="me-1"><%=items.name_category%></span><span
                    class="text-secondary">(<%=items.Category_Count%>)</span></a>
            <% }); %>
        </div>
        <div class="row g-3">
            <!-- <div class="col-8">
                <div class="position-relative">
                    <form action="" method="post">
                        <input class="form-control px-5" name="searchProduct" type="search"
                            placeholder="Search Products">
                    </form>
                    <span
                        class="material-icons-outlined position-absolute ms-3 translate-middle-y start-0 top-50 fs-5">search</span>
                </div>
            </div> -->
            <div class="col-auto flex-grow-1 overflow-auto">
            </div>
            <div class="col-auto">
                <div class="d-flex align-items-center gap-2 justify-content-lg-end">

                    <a href="/admin/add-product" class="btn btn-primary px-4">Add
                        Product</a>
                </div>
            </div>
        </div>
        <h6 class="mb-0 text-uppercase"> List Product</h6>
        <hr>
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table id="example2" class="table table-striped table-bordered">
                        <thead>
                            <tr class="table-light">
                                <th class="text-center ">#ID</th>
                                <th class="text-center ">Product</th>
                                <th class="text-center ">Price</th>
                                <th class="text-center ">Price Sale</th>
                                <th class="text-center ">Rating</th>
                                <th class="text-center ">Views</th>
                                <th class="text-center ">Date </th>
                                <th class="text-center ">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% listProduct.forEach(function(items) { %>
                            <tr>
                                <td><%= items.id %></td>
                                <td>
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="product-box">
                                            <img src="/assets/img/product/<%= items.image_product  %>" width="70"
                                                height="70px" class="rouÆ°nded-3" alt="">
                                        </div>
                                        <div class="product-info">
                                            <a href="javascript:;" class="product-title"><%= items.name_product  %></a>
                                            <p class="mb-0 product-category">Category :
                                                <%= items.Category.name_category %>
                                            </p>
                                        </div>
                                    </div>
                                </td>
                                <td><%= formatCurrency(items.price_product)  %></td>
                                <td><%= items.price_sale  %>%</td>
                                <%  function formatCurrency(amount) {
                                    return amount.toLocaleString('vi-VN', {
                                        style: 'currency',
                                        currency: 'VND'
                                    });
                                } %>
                                <td>
                                    <div class="product-rating">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="14" width="15.75"
                                            viewBox="0 0 576 512">
                                            <path fill="#FFD43B"
                                                d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
                                        </svg>
                                        <span><%= items.rating_product %></span>
                                    </div>
                                </td>
                                <td>
                                </td>
                                <td>
                                    <%= formatDate(items.createdAt) %>
                                </td>
                                <td class="d-flex ">
                                    <a class="p-4" href="/admin/edit-product/<%= items.id %>"><svg
                                            xmlns="http://www.w3.org/2000/svg" height="24" width="24"
                                            viewBox="0 0 512 512">
                                            <path fill="#6ee665"
                                                d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160L0 416c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-96c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 64z" />
                                        </svg></a>
                                    <a class="p-4" href="/admin/change-status-product/<%= items.id%>"><svg
                                            xmlns="http://www.w3.org/2000/svg" height="24" width="21"
                                            viewBox="0 0 448 512">
                                            <path fill="#ff0000"
                                                d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z" />
                                        </svg></a>

                                </td>
                            </tr>
                            <% }); %>
                        </tbody>
                        <tfoot>
                            <tr class="table-light">
                                <th class="text-center ">#ID</th>
                                <th class="text-center ">Product</th>
                                <th class="text-center ">Price</th>
                                <th class="text-center ">Price Sale</th>
                                <th class="text-center ">Rating</th>
                                <th class="text-center ">Views</th>
                                <th class="text-center ">Date </th>
                                <th class="text-center ">Action</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
</main>
<script>
    document.getElementById('changeProduct').addEventListener('click', function (event) {
        event.preventDefault();
        var url = this.getAttribute('href');
        Swal.fire({
            title: "Are you sure?",
            text: "You can find it in the trash !",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "Yes, delete it!"
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire({
                    title: "Deleted!",
                    text: "Your file has been deleted.",
                    icon: "success"
                }).then((result) => {
                    window.location.href = url;
                })
            }
        });
    });
</script>

<%- include('footer') -%>